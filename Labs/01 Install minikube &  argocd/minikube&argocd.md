## <font color='red'> 1.1 K8s Cluster </font>
Lab demonstrates a possible GitOps workflow using Argo CD and Tekton. We are using Argo CD to setup our Kubernetes clusters dev and prod (in the following we will only use the dev cluster) and Tekton to build and update our example application.

In this lab we're going to:
* install Dev minikube cluster
* enable Ingress controller

---

#### <font color='red'>IMPORTANT:</font> 
<strong>Please ensure you start with a clean environment. 
If you have previously run minikube, you will need to delete the existing instance.</strong>

to stop  minikube:
```
minikube stop
```
to delete  minikube:
```
minikube delete
```

---

Pre-requisties:
* GitOps is a way to do Kubernetes cluster management and application delivery.  It works by using Git as a single source of truth for declarative infrastructure and applications. With GitOps, the use of software agents can alert on any divergence between Git with what's running in a cluster, and if there's a difference, Kubernetes reconcilers automatically update or rollback the cluster depending on the case. With Git at the center of your delivery pipelines, developers use familiar tools to make pull requests to accelerate and simplify both application deployments and operations tasks to Kubernetes.

you will require a GitHub account.

* Docker Hub


---

#### <font color='red'>1.1.1  Install Dev & ArgoCD K8s Clusters </font>
The next step is to create two Kubernetes clusters: 
* k8s-dev - push your application and run it
* k8s-argocd - install ArgoCD

start k8s-dev cluster:
```
minikube start -p k8s-dev
```
start k8s-argocd cluster:
```
minikube start -p k8s-argocd
```
confirm that your k8s-argocd context is set correctly:
```
kubectl config use-context argocd-k8s
```

---

## <font color='red'> 1.2 ArgoCD </font>
ArgoCD is a declarative GitOps tool built to deploy applications to Kubernetes. While the continuous delivery (CD) space is seen by some as crowded these days, ArgoCD does bring some interesting capabilities to the table.

Unlike other tools, ArgoCD is lightweight and easy to configure. It is purpose-built to deploy applications to Kubernetes so it doesnâ€™t have the UI overhead of many tools built to deploy to multiple locations.

In this lab we're going to:
* install ArgoCD
* install ArgoCD CLI

#### <font color='red'>1.2.1  Install ArgoCD </font>
create namespace argocd:
```
kubectl create namespace argocd:
```
install ArgoCD:
```
kubectl apply -n argocd -f 01_install-argocd.yaml
```
Note: this will take a few minutes...

verfiy ArgoCD:
```
kubectl get pods -n argocd
```
port-forward to expose service on localhost:8080:
```
kubectl port-forward svc/argocd-server -n argocd 8080:443
```

browse to ArgoCD > http://localhost:8080

user: admin

initial password is autogenerated:
```
kubectl get pods -n argocd -l app.kubernetes.io/name=argocd-server -o name | cut -d'/' -f 2
```
Note: In the UI of Argo CD we can now see all deployed applications.

---


#### <font color='red'>1.2.2 Install ArgoCD CLI </font>

go to the releases site on GitHub:
```
https://github.com/argoproj/argo-cd/releases


select the correct version:

rename the file and move to $PATH:
```
mv argocd-linux-amd64 argocd && mv argocd /usr/local/bin
```


---